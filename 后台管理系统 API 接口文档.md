<!-- TOC -->

- [1. 后台管理系统 API 接口文档](#1-后台管理系统-api-接口文档)
    - [1.1. API V1 接口说明](#11-api-v1-接口说明)
        - [1.1.1. 支持的请求方法](#111-支持的请求方法)
        - [1.1.2. 通用返回状态说明](#112-通用返回状态说明)
    - [1.2. 登录](#12-登录)
        - [1.2.1. 登录验证接口](#121-登录验证接口)
    - [1.3. 管理员管理](#13-管理员管理)
        - [1.3.1. 管理员数据列表](#131-管理员数据列表)
        - [1.3.2. 添加管理员](#132-添加管理员)
        - [1.3.3. 修改管理员状态](#133-修改管理员状态)
        - [1.3.4. 修改管理员信息](#134-修改管理员信息)
        - [1.3.5. 删除管理员](#135-删除管理员)
        - [1.3.6. 分配管理员角色](#136-分配管理员角色)
    - [1.4. 权限管理](#14-权限管理)
        - [1.4.1. 所有权限列表](#141-所有权限列表)
        - [1.4.2. 左侧菜单](#142-左侧菜单)
    - [1.5. 角色管理](#15-角色管理)
        - [1.5.1. 角色列表](#151-角色列表)
        - [1.5.2. 添加角色](#152-添加角色)
        - [1.5.3. 编辑提交角色](#153-编辑提交角色)
        - [1.5.4. 删除角色](#154-删除角色)
        - [1.5.5. 角色授权](#155-角色授权)
        - [1.5.6. 删除角色指定权限](#156-删除角色指定权限)
    - [1.6. 商品分类管理](#16-商品分类管理)
        - [1.6.1. 商品分类数据列表](#161-商品分类数据列表)
        - [1.6.2. 添加分类](#162-添加分类)
        - [1.6.3. 编辑提交分类](#163-编辑提交分类)
        - [1.6.4. 删除分类](#164-删除分类)
    - [1.7. 商品管理](#17-商品管理)
        - [1.7.1. 商品列表数据](#171-商品列表数据)

<!-- /TOC -->



# 1. 后台管理系统 API 接口文档

## 1.1. API V1 接口说明

- 后台管理系统接口基准地址：`http://127.0.0.1:8888/admin/`
- 服务端已开启 CORS 跨域支持
- API V1 认证统一使用 Token 认证
- 需要授权的 API ，必须在请求头中使用 `Authorization` 字段提供 `token` 令牌
- 使用 HTTP Status Code 标识状态
- 数据返回格式统一使用 JSON

### 1.1.1. 支持的请求方法

- GET（SELECT）：从服务器取出资源（一项或多项）。
- POST（CREATE）：在服务器新建一个资源。
- PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。
- PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。
- DELETE（DELETE）：从服务器删除资源。
- HEAD：获取资源的元数据。
- OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。

### 1.1.2. 通用返回状态说明

| *状态码* | *含义*                | *说明*                                              |
| -------- | --------------------- | --------------------------------------------------- |
| 200      | OK                    | 请求成功                                            |
| 201      | CREATED               | 创建成功                                            |
| 204      | DELETED               | 删除成功                                            |
| 400      | BAD REQUEST           | 请求的地址不存在或者包含不支持的参数                |
| 401      | UNAUTHORIZED          | 未授权                                              |
| 403      | FORBIDDEN             | 被禁止访问                                          |
| 404      | NOT FOUND             | 请求的资源不存在                                    |
| 422      | Unprocesable entity   | [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误 |
| 500      | INTERNAL SERVER ERROR | 内部错误                                            |
|          |                       |                                                     |

------

## 1.2. 登录

### 1.2.1. 登录验证接口

- 请求路径：login
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| name | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

- 响应参数

| 参数名   | 参数说明    | 备注            |
| -------- | ----------- | --------------- |
| token    | 令牌        | 基于 jwt 的令牌 |

- 响应数据

```json
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZTZlZWQzYTZkYmFkNzQwZjgwNzA1NTAiLCJpYXQiOjE1ODQzNTc3ODQsImV4cCI6MTU4NDM2MTM4NH0.tamgTXKkubn_6Rp4pf_3mzM_UFb6Se8rLyq9-bSssCM"

```

- 返回状态
```
 200
```

## 1.3. 管理员管理

### 1.3.1. 管理员数据列表

- 请求路径：admins
- 请求方法：get
- 请求参数

| 参数名   | 参数说明     | 备注     |
| -------- | ------------ | -------- |
| query    | 查询参数     | 可以为空 |
| pagenum  | 当前页码     | 不能为空 |
| pagesize | 每页显示条数 | 不能为空 |

- 响应参数

| 参数名    | 参数说明     | 备注 |
| --------- | ------------ | ---- |
| totalpage | 总记录数     |      |
| data     | 管理员数据集合 |      |

- 响应数据

```json
{
    "data": [
        {
            "state": true,
            "_id": "5e6eed3a6dbad740f8070550",
            "name": "auroralorigin",
            "mobile": "13845678911",
            "email": "123@qq.com",
            "role": {
                "_id": "5e7472eadc674611e4c10a9a",
                "name": "超级管理员"
            }
        },
        {
            "state": true,
            "_id": "5e6f343374d5792c6c0e213c",
            "name": "aurora",
            "mobile": "13888888886",
            "email": "aurora@qq.com",
            "role": {
                "_id": "5e7472eadc674611e4c10a9a",
                "name": "超级管理员"
            }
        }
    ],
    "totalpage": 2
}
```

- 返回状态
```
 200
```

### 1.3.2. 添加管理员

- 请求路径：admins
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| name | 用户名 | 不能为空 |
| password | 密码 | 不能为空 |
| email    | 邮箱     | 可以为空 |
| mobile   | 手机号   | 可以为空 |

- 响应参数

| 参数名   | 参数说明    | 备注 |
| -------- | ----------- | ---- |
| 无       | 无     |      |


- 响应数据

```json
 null
```
- 返回状态
```
 201
```

### 1.3.3. 修改管理员状态

- 请求路径：admins/:_id/state/:state
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                                        |
| ------ | -------- | ------------------------------------------- |
| _id    | 用户 ID  | 不能为空`携带在url中`                       |
| state   | 用户状态 | 不能为空`携带在url中`，值为 true 或者 false |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |
- 响应数据

```json
null
```
- 返回状态
```
 200
```
### 1.3.4. 修改管理员信息

- 请求路径：admins/:_id
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                        |
| ------ | -------- | --------------------------- |
| _id     | 用户 id  | 不能为空 `参数是url参数:id` |
| email  | 邮箱     | 可以为空                    |
| mobile | 手机号   | 可以为空                    |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |


- 响应数据

```json
null
```
- 返回状态
```
 200
```

### 1.3.5. 删除管理员

- 请求路径：admins/:_id
- 请求方法：delete
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| _id     | 用户 id  | 不能为空`参数是url参数:_id` |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |
- 响应数据

```json
null
```
- 返回状态
```
 204
```

### 1.3.6. 分配管理员角色 

- 请求路径：admins/:_id/role
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| _id     | 管理员 id  | 不能为空`参数是url参数:_id` |
| rid    | 角色 id  | 不能为空`参数body参数`     |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |

- 响应数据

```json
null
```
- 返回状态

```
 200
```

## 1.4. 权限管理

### 1.4.1. 所有权限列表

- 请求路径：rights/:type
- 请求方法：get
- 请求参数

| 参数名 | 参数说明 | 备注                                                         |
| ------ | -------- | ------------------------------------------------------------ |
| type   | 类型     | 值 list 或 tree , list 列表显示权限, tree 树状显示权限,`参数是url参数:type` |

- 响应参数

| 参数名   | 参数说明     | 备注 |
| -------- | ------------ | ---- |
| _id       | 权限 ID      |      |
| name | 权限名称     |      |
| pid      | 权限父 ID    |      |
| path     | 对应访问路径 |      |

- 响应数据

type = list

```json
[
    {
        "pid": [],
        "_id": "5e71d72f993f6246d8147c27",
        "name": "管理员管理",
        "path": "admins"
    },
    {
        "pid": [
            "5e71d72f993f6246d8147c27"
        ],
        "_id": "5e71d7753ff3ed1d2cd660d2",
        "name": "管理员列表",
        "path": "admins"
    },
    {
        "pid": [
            "5e71d7753ff3ed1d2cd660d2",
            "5e71d72f993f6246d8147c27"
        ],
        "_id": "5e71db1637108f3db096cb35",
        "name": "添加管理员",
        "path": "admins"
    }
]
```

type = tree

```json
[
    {
        "_id": "5e71d72f993f6246d8147c27",
        "pid": [],
        "name": "管理员管理",
        "path": "admins",
        "children": [
            {
                "_id": "5e71d7753ff3ed1d2cd660d2",
                "pid": [
                    "5e71d72f993f6246d8147c27"
                ],
                "name": "管理员列表",
                "path": "admins",
                "children": [
                    {
                        "pid": [
                            "5e71d7753ff3ed1d2cd660d2",
                            "5e71d72f993f6246d8147c27"
                        ],
                        "_id": "5e71db1637108f3db096cb35",
                        "name": "添加管理员",
                        "path": "admins"
                    }
                ]
            }
        ]
    }
]
```

- 返回状态

```
 200
```

### 1.4.2. 左侧菜单

- 请求路径：menus
- 请求方法：get
- 响应数据

```json
[
    {
        "_id": "5e71d72f993f6246d8147c27",
        "name": "管理员管理",
        "path": "admins",
        "children": [
            {
                "_id": "5e71d7753ff3ed1d2cd660d2",
                "name": "管理员列表",
                "path": "admins"
            }
        ]
    },
    {
        "_id": "5e72e81b9e064435c4a7c5cd",
        "name": "权限管理",
        "path": "rights",
        "children": [
            {
                "_id": "5e72e84668380434a0d09eec",
                "name": "角色列表",
                "path": "rights"
            },
            {
                "_id": "5e72e84668380434a0d09eed",
                "name": "权限列表",
                "path": "rights"
            }
        ]
    }
]
```
- 返回状态

```
 200
```

## 1.5. 角色管理

### 1.5.1. 角色列表

- 请求路径：roles

- 请求方法：get

- 响应数据说明

  + 第一层为角色信息

  - 第二层开始为权限说明，权限一共有 3 层权限
  - 最后一层权限，不包含 `children` 属性

- 响应数据

```json
[
    {
        "_id": "5e7326df1382fe3638ff6ebb",
        "children": [
            {
                "_id": "5e71d72f993f6246d8147c27",
                "name": "管理员管理",
                "path": "admins",
                "children": [
                    {
                        "_id": "5e71d7753ff3ed1d2cd660d2",
                        "name": "管理员列表",
                        "path": "admins",
                        "children": [
                            {
                                "_id": "5e71db1637108f3db096cb35",
                                "name": "添加管理员",
                                "path": "admins"
                            }
                        ]
                    }
                ]
            }
        ],
        "name": "超级管理员",
        "desc": "拥有所有权限"
    }
]
```
- 返回状态

```
 200
```
### 1.5.2. 添加角色

- 请求路径：roles
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| name | 角色名称 | 不能为空 |
| desc | 角色描述 | 可以为空 |

- 响应参数

| 参数名   | 参数说明 | 备注 |
| -------- | -------- | ---- |
| 无   | 无  |      |

- 响应数据

```json
null
```
- 返回状态
```
201
```
### 1.5.3. 编辑提交角色

- 请求路径：roles/:_id
- 请求方法：put
- 请求参数

| 参数名   | 参数说明 | 备注                  |
| -------- | -------- | --------------------- |
| :_id      | 角色 ID  | 不能为空`携带在url中` |
| name | 角色名称 | 不能为空              |
| desc | 角色描述 | 可以为空              |

- 响应数据

```json
null
```
- 返回状态
```
200
```

### 1.5.4. 删除角色

- 请求路径：roles/:_id
- 请求方法：delete
- 请求参数

| 参数名 | 参数说明 | 备注                  |
| ------ | -------- | --------------------- |
| :id    | 角色 ID  | 不能为空`携带在url中` |

- 响应数据

```json
null
```
- 返回状态
```
204
```


### 1.5.5. 角色授权

- 请求路径：roles/:_id/rights
- 请求方法：post
- 请求参数：通过 `请求体` 发送给后端

| 参数名  | 参数说明               | 备注                                                         |
| ------- | ---------------------- | ------------------------------------------------------------ |
| :_id | 角色 id                | 不能为空`携带在url中`                                        |
| rids    | 权限 ID 列表（字符串） | 以 `,` 分割的权限 ID 列表（获取所有被选中、叶子节点的key和半选中节点的key, 包括 1，2，3级节点） |

- 响应数据

```json
null
```
- 返回状态
```
200
```

### 1.5.6. 删除角色指定权限

- 请求路径：roles/:roleId/rights/:rightId

- 请求方法：delete

- 请求参数

  | 参数名   | 参数说明 | 备注                  |
  | -------- | -------- | --------------------- |
  | :roleId  | 角色 ID  | 不能为空`携带在url中` |
  | :rightId | 权限 ID  | 不能为空`携带在url中` |

- 响应数据说明 

  - 无

- 响应数据

```json
null
```
  - 返回状态
```
204
```
## 1.6. 商品分类管理

### 1.6.1. 商品分类数据列表

- 请求路径：categories
- 请求方法：get
- 请求参数

| 参数名   | 参数说明           | 备注                                                         |
| -------- | ------------------ | ------------------------------------------------------------ |
|
| pagenum  | 当前页码值         | 【可选参数】如果不传递，则默认获取所有分类                   |
| pagesize | 每页显示多少条数据 | 【可选参数】如果不传递，则默认获取所有分类                   |

- 响应参数

| 参数名    | 参数说明     | 备注 |
| --------- | ------------ | ---- |
| _id    | 分类 ID      |      |
| name  | 分类名称     |      |

- 响应数据

```json
[
    {
        "_id": "5e75b1f4e5512a0f1c03b0c1",
        "name": "鱼类"
    },
    {
        "_id": "5e75b24d44733839f87b9065",
        "name": "醉类"
    },
    {
        "_id": "5e75b24d44733839f87b9066",
        "name": "虾类"
    },
    {
        "_id": "5e75b24d44733839f87b9067",
        "name": "贝类"
    }
]
```
  - 返回状态
```
200
```

### 1.6.2. 添加分类

- 请求路径：categories
- 请求方法：post
- 请求参数

| 参数名    | 参数说明  | 备注                                                        |
| --------- | --------- | ----------------------------------------------------------- |
|
| name  | 分类名称  | 不能为空                                                    |


- 响应数据

```json
null
```
  - 返回状态
```
201
```
### 1.6.3. 编辑提交分类

- 请求路径：categories/:_id
- 请求方法：put
- 请求参数

| 参数名   | 参数说明 | 备注                             |
| -------- | -------- | -------------------------------- |
| :_id      | 分类 ID  | 不能为空`携带在url中`            |
| name | 分类名称 | 不能为空【此参数，放到请求体中】 |

- 响应数据

```json
null
```
  - 返回状态
```
200
```

### 1.6.4. 删除分类

- 请求路径：categories/:_id
- 请求方法：delete
- 请求参数

| 参数名 | 参数说明 | 备注                  |
| ------ | -------- | --------------------- |
| :_id    | 分类 ID  | 不能为空`携带在url中` |

- 响应数据

```json
null
```
  - 返回状态
```
204
```
## 1.7. 商品管理

### 1.7.1. 商品列表数据

- 请求路径：goods
- 请求方法：get
- 请求参数

| 参数名   | 参数说明     | 备注     |
| -------- | ------------ | -------- |
| query    | 查询参数     | 可以为空 |
| pagenum  | 当前页码     | 不能为空 |
| pagesize | 每页显示条数 | 不能为空 |

- 响应参数

| 参数名       | 参数说明     | 备注                                   |
| ------------ | ------------ | -------------------------------------- |
| total        | 总共商品条数 |                                        |
| pagenum      | 当前商品页数 |                                        |
| goods_id     | 商品 ID      |                                        |
| goods_name   | 商品名称     |                                        |
| goods_price  | 价格         |                                        |
| goods_number | 数量         |                                        |
| goods_weight | 重量         | 不能为空                               |
| goods_state  | 商品状态     | 商品状态 0: 未通过 1: 审核中 2: 已审核 |
| add_time     | 添加时间     |                                        |
| upd_time     | 更新时间     |                                        |
| hot_mumber   | 热销品数量   |                                        |
| is_promote   | 是否是热销品 |                                        |

- 响应数据

```json
{
    "data": {
        "total": 50,
        "pagenum": "1",
        "goods": [
            {
                "goods_id": 144,
                "goods_name": "asfdsd",
                "goods_price": 1,
                "goods_number": 1,
                "goods_weight": 1,
                "goods_state": null,
                "add_time": 1512954923,
                "upd_time": 1512954923,
                "hot_mumber": 0,
                "is_promote": false
            }
        ]
    },
    "meta": {
        "msg": "获取成功",
        "status": 200
    }
}
```