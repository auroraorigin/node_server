# 1. 后台管理系统 API 接口文档

## 1.1. API V1 接口说明

- 后台管理系统接口基准地址：`http://127.0.0.1:8888/admin/`
- 服务端已开启 CORS 跨域支持
- API V1 认证统一使用 Token 认证
- 需要授权的 API ，必须在请求头中使用 `Authorization` 字段提供 `token` 令牌
- 使用 HTTP Status Code 标识状态
- 数据返回格式统一使用 JSON

### 1.1.1. 支持的请求方法

- GET（SELECT）：从服务器取出资源（一项或多项）。
- POST（CREATE）：在服务器新建一个资源。
- PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。
- PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。
- DELETE（DELETE）：从服务器删除资源。
- HEAD：获取资源的元数据。
- OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。

### 1.1.2. 通用返回状态说明

| *状态码* | *含义*                | *说明*                                              |
| -------- | --------------------- | --------------------------------------------------- |
| 200      | OK                    | 请求成功                                            |
| 201      | CREATED               | 创建成功                                            |
| 204      | DELETED               | 删除成功                                            |
| 400      | BAD REQUEST           | 请求的地址不存在或者包含不支持的参数                |
| 401      | UNAUTHORIZED          | 未授权                                              |
| 403      | FORBIDDEN             | 被禁止访问                                          |
| 404      | NOT FOUND             | 请求的资源不存在                                    |
| 422      | Unprocesable entity   | [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误 |
| 500      | INTERNAL SERVER ERROR | 内部错误                                            |
|          |                       |                                                     |

------

## 1.2. 登录

### 1.2.1. 登录验证接口

- 请求路径：login
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| name | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

- 响应参数

| 参数名   | 参数说明    | 备注            |
| -------- | ----------- | --------------- |
| token    | 令牌        | 基于 jwt 的令牌 |

- 响应数据

```json
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZTZlZWQzYTZkYmFkNzQwZjgwNzA1NTAiLCJpYXQiOjE1ODQzNTc3ODQsImV4cCI6MTU4NDM2MTM4NH0.tamgTXKkubn_6Rp4pf_3mzM_UFb6Se8rLyq9-bSssCM"

```

- 返回状态
```
 200
```

## 1.3. 管理员管理

### 1.3.1. 管理员数据列表

- 请求路径：admins
- 请求方法：get
- 请求参数

| 参数名   | 参数说明     | 备注     |
| -------- | ------------ | -------- |
| query    | 查询参数     | 可以为空 |
| pagenum  | 当前页码     | 不能为空 |
| pagesize | 每页显示条数 | 不能为空 |

- 响应参数

| 参数名    | 参数说明     | 备注 |
| --------- | ------------ | ---- |
| totalpage | 总记录数     |      |
| data     | 管理员数据集合 |      |

- 响应数据

```json
{
    "data": [
        {
            "state": true,
            "_id": "5e6eed3a6dbad740f8070550",
            "name": "auroralorigin",
            "password": "$2b$10$d27DWzR3jv2OHhlZTADlJez8wtXxJfw1t9Amm.bRGIcgZlfCZUNQC",
            "mobile": "13888888888",
            "email": "226608960@qq.com",
            "role": "admin",
            "__v": 0
        }
    ],
    "totalpage": 3
}
```

- 返回状态
```
 200
```

### 1.3.2. 添加管理员

- 请求路径：admins
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| name | 用户名 | 不能为空 |
| password | 密码 | 不能为空 |
| email    | 邮箱     | 可以为空 |
| mobile   | 手机号   | 可以为空 |

- 响应参数

| 参数名   | 参数说明    | 备注 |
| -------- | ----------- | ---- |
| 无       | 无     |      |


- 响应数据

```json
 null
```
- 返回状态
```
 201
```

### 1.3.3. 修改管理员状态

- 请求路径：admins/:_id/state/:state
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                                        |
| ------ | -------- | ------------------------------------------- |
| _id    | 用户 ID  | 不能为空`携带在url中`                       |
| state   | 用户状态 | 不能为空`携带在url中`，值为 true 或者 false |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |
- 响应数据

```json
null
```
- 返回状态
```
 200
```
### 1.3.4. 编辑管理员提交

- 请求路径：admins/:_id
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                        |
| ------ | -------- | --------------------------- |
| _id     | 用户 id  | 不能为空 `参数是url参数:id` |
| email  | 邮箱     | 可以为空                    |
| mobile | 手机号   | 可以为空                    |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |


- 响应数据

```json
null
```
- 返回状态
```
 200
```

### 1.3.5. 删除管理员

- 请求路径：admins/:_id
- 请求方法：delete
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| _id     | 用户 id  | 不能为空`参数是url参数:_id` |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |
- 响应数据

```json
null
```
- 返回状态
```
 200
```

### 1.3.6. 分配管理员角色 /* 尚未完成 */

- 请求路径：admins/:_id/role
- 请求方法：put
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| _id     | 管理员 id  | 不能为空`参数是url参数:_id` |
| rid    | 角色 id  | 不能为空`参数body参数`     |

- 响应参数

| 参数名  | 参数说明 | 备注 |
| ------- | -------- | ---- |
| 无      | 无  |      |

- 响应数据

```json
null
```
- 返回状态

```
 200
```